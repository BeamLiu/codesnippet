

data/sms_spam_collection/SMSSpamCollection.tsv already exists. Skipping download and extraction.
Training samples: 1195
Validation samples: 149
Test samples: 150
Using cuda device.
Found local directory: models/Qwen3-0.6B-Base
--------------------------------------------------
Loading tokenizer and model...
Loading weights: 100% 310/310 [00:00<00:00, 933.98it/s, Materializing param=model.norm.weight] 
Qwen3ForSequenceClassification LOAD REPORT from: models/Qwen3-0.6B-Base
Key          | Status  | 
-------------+---------+-
score.weight | MISSING | 

Notes:
- MISSING	:those params were newly initialized because missing from the checkpoint. Consider training on your downstream task.
--------------------------------------------------
trainable params: 10,094,592 || all params: 606,146,560 || trainable%: 1.6654
None
--------------------------------------------------
Inputs: tensor([[5404,  498,  614,  882]], device='cuda:0')
Inputs dimensions: torch.Size([1, 4])
Outputs (logits): tensor([[ 0.7109, -2.7656]], device='cuda:0', dtype=torch.bfloat16)
Outputs dimensions: torch.Size([1, 2])
--------------------------------------------------
Fine-tuning the model using Hugging Face Trainer...
{'loss': '0.1847', 'grad_norm': '0.05584', 'learning_rate': '4.34e-05', 'epoch': '0.6667'}
 13% 100/750 [01:38<11:35,  1.07s/it]
  0% 0/19 [00:00<?, ?it/s]
 11% 2/19 [00:00<00:04,  4.10it/s]
 16% 3/19 [00:00<00:05,  2.89it/s]
 21% 4/19 [00:01<00:06,  2.49it/s]
 26% 5/19 [00:01<00:06,  2.31it/s]
 32% 6/19 [00:02<00:05,  2.20it/s]
 37% 7/19 [00:02<00:05,  2.15it/s]
 42% 8/19 [00:03<00:05,  2.11it/s]
 47% 9/19 [00:03<00:04,  2.09it/s]
 53% 10/19 [00:04<00:04,  2.07it/s]
 58% 11/19 [00:04<00:03,  2.06it/s]
 63% 12/19 [00:05<00:03,  2.05it/s]
 68% 13/19 [00:05<00:02,  2.04it/s]
 74% 14/19 [00:06<00:02,  2.03it/s]
 79% 15/19 [00:06<00:01,  2.03it/s]
 84% 16/19 [00:07<00:01,  2.04it/s]
 89% 17/19 [00:07<00:00,  2.04it/s]
 95% 18/19 [00:08<00:00,  2.03it/s]
                                     
{'eval_loss': '0.1789', 'eval_accuracy': '0.953', 'eval_runtime': '9.174', 'eval_samples_per_second': '16.24', 'eval_steps_per_second': '2.071', 'epoch': '0.6667'}
 13% 100/750 [01:47<11:35,  1.07s/it]
100% 19/19 [00:08<00:00,  2.28it/s]
{'loss': '0.03572', 'grad_norm': '0.386', 'learning_rate': '3.673e-05', 'epoch': '1.333'}
 27% 200/750 [03:32<09:36,  1.05s/it]
  0% 0/19 [00:00<?, ?it/s]
 11% 2/19 [00:00<00:04,  4.18it/s]
 16% 3/19 [00:00<00:05,  2.96it/s]
 21% 4/19 [00:01<00:05,  2.56it/s]
 26% 5/19 [00:01<00:05,  2.37it/s]
 32% 6/19 [00:02<00:05,  2.27it/s]
 37% 7/19 [00:02<00:05,  2.21it/s]
 42% 8/19 [00:03<00:05,  2.17it/s]
 47% 9/19 [00:03<00:04,  2.15it/s]
 53% 10/19 [00:04<00:04,  2.13it/s]
 58% 11/19 [00:04<00:03,  2.12it/s]
 63% 12/19 [00:05<00:03,  2.11it/s]
 68% 13/19 [00:05<00:02,  2.10it/s]
 74% 14/19 [00:06<00:02,  2.10it/s]
 79% 15/19 [00:06<00:01,  2.10it/s]
 84% 16/19 [00:07<00:01,  2.10it/s]
 89% 17/19 [00:07<00:00,  2.10it/s]
 95% 18/19 [00:08<00:00,  2.10it/s]
                                     
{'eval_loss': '0.199', 'eval_accuracy': '0.9664', 'eval_runtime': '8.91', 'eval_samples_per_second': '16.72', 'eval_steps_per_second': '2.132', 'epoch': '1.333'}
 27% 200/750 [03:41<09:36,  1.05s/it]
100% 19/19 [00:08<00:00,  2.35it/s]
{'loss': '0.0317', 'grad_norm': '5.388e-06', 'learning_rate': '3.007e-05', 'epoch': '2'}
 40% 300/750 [05:26<06:30,  1.15it/s]
  0% 0/19 [00:00<?, ?it/s]
 11% 2/19 [00:00<00:04,  4.21it/s]
 16% 3/19 [00:00<00:05,  2.97it/s]
 21% 4/19 [00:01<00:05,  2.57it/s]
 26% 5/19 [00:01<00:05,  2.39it/s]
 32% 6/19 [00:02<00:05,  2.28it/s]
 37% 7/19 [00:02<00:05,  2.22it/s]
 42% 8/19 [00:03<00:05,  2.18it/s]
 47% 9/19 [00:03<00:04,  2.15it/s]
 53% 10/19 [00:04<00:04,  2.14it/s]
 58% 11/19 [00:04<00:03,  2.12it/s]
 63% 12/19 [00:05<00:03,  2.12it/s]
 68% 13/19 [00:05<00:02,  2.11it/s]
 74% 14/19 [00:06<00:02,  2.11it/s]
 79% 15/19 [00:06<00:01,  2.11it/s]
 84% 16/19 [00:07<00:01,  2.10it/s]
 89% 17/19 [00:07<00:00,  2.10it/s]
 95% 18/19 [00:08<00:00,  2.10it/s]
                                     
{'eval_loss': '0.1147', 'eval_accuracy': '0.9597', 'eval_runtime': '8.886', 'eval_samples_per_second': '16.77', 'eval_steps_per_second': '2.138', 'epoch': '2'}
 40% 300/750 [05:35<06:30,  1.15it/s]
100% 19/19 [00:08<00:00,  2.35it/s]
{'loss': '0.0006999', 'grad_norm': '0.006485', 'learning_rate': '2.34e-05', 'epoch': '2.667'}
 53% 400/750 [07:20<06:08,  1.05s/it]
  0% 0/19 [00:00<?, ?it/s]
 11% 2/19 [00:00<00:04,  4.18it/s]
 16% 3/19 [00:00<00:05,  2.96it/s]
 21% 4/19 [00:01<00:05,  2.56it/s]
 26% 5/19 [00:01<00:05,  2.38it/s]
 32% 6/19 [00:02<00:05,  2.28it/s]
 37% 7/19 [00:02<00:05,  2.21it/s]
 42% 8/19 [00:03<00:05,  2.18it/s]
 47% 9/19 [00:03<00:04,  2.15it/s]
 53% 10/19 [00:04<00:04,  2.14it/s]
 58% 11/19 [00:04<00:03,  2.13it/s]
 63% 12/19 [00:05<00:03,  2.12it/s]
 68% 13/19 [00:05<00:02,  2.11it/s]
 74% 14/19 [00:06<00:02,  2.11it/s]
 79% 15/19 [00:06<00:01,  2.11it/s]
 84% 16/19 [00:07<00:01,  2.10it/s]
 89% 17/19 [00:07<00:00,  2.10it/s]
 95% 18/19 [00:08<00:00,  2.10it/s]
                                     
{'eval_loss': '0.1301', 'eval_accuracy': '0.9664', 'eval_runtime': '8.89', 'eval_samples_per_second': '16.76', 'eval_steps_per_second': '2.137', 'epoch': '2.667'}
 53% 400/750 [07:29<06:08,  1.05s/it]
100% 19/19 [00:08<00:00,  2.35it/s]
{'loss': '0.0001645', 'grad_norm': '0.0001287', 'learning_rate': '1.673e-05', 'epoch': '3.333'}
 67% 500/750 [09:14<04:21,  1.05s/it]
  0% 0/19 [00:00<?, ?it/s]
 11% 2/19 [00:00<00:04,  4.20it/s]
 16% 3/19 [00:00<00:05,  2.96it/s]
 21% 4/19 [00:01<00:05,  2.57it/s]
 26% 5/19 [00:01<00:05,  2.38it/s]
 32% 6/19 [00:02<00:05,  2.28it/s]
 37% 7/19 [00:02<00:05,  2.22it/s]
 42% 8/19 [00:03<00:05,  2.18it/s]
 47% 9/19 [00:03<00:04,  2.15it/s]
 53% 10/19 [00:04<00:04,  2.14it/s]
 58% 11/19 [00:04<00:03,  2.12it/s]
 63% 12/19 [00:05<00:03,  2.11it/s]
 68% 13/19 [00:05<00:02,  2.11it/s]
 74% 14/19 [00:06<00:02,  2.10it/s]
 79% 15/19 [00:06<00:01,  2.10it/s]
 84% 16/19 [00:07<00:01,  2.10it/s]
 89% 17/19 [00:07<00:00,  2.10it/s]
 95% 18/19 [00:08<00:00,  2.10it/s]
                                     
{'eval_loss': '0.1578', 'eval_accuracy': '0.9664', 'eval_runtime': '8.894', 'eval_samples_per_second': '16.75', 'eval_steps_per_second': '2.136', 'epoch': '3.333'}
 67% 500/750 [09:22<04:21,  1.05s/it]
100% 19/19 [00:08<00:00,  2.35it/s]
{'loss': '2.141e-05', 'grad_norm': '7.241e-05', 'learning_rate': '1.007e-05', 'epoch': '4'}
 80% 600/750 [11:07<02:09,  1.16it/s]
  0% 0/19 [00:00<?, ?it/s]
 11% 2/19 [00:00<00:04,  4.17it/s]
 16% 3/19 [00:00<00:05,  2.96it/s]
 21% 4/19 [00:01<00:05,  2.56it/s]
 26% 5/19 [00:01<00:05,  2.38it/s]
 32% 6/19 [00:02<00:05,  2.28it/s]
 37% 7/19 [00:02<00:05,  2.21it/s]
 42% 8/19 [00:03<00:05,  2.17it/s]
 47% 9/19 [00:03<00:04,  2.15it/s]
 53% 10/19 [00:04<00:04,  2.13it/s]
 58% 11/19 [00:04<00:03,  2.12it/s]
 63% 12/19 [00:05<00:03,  2.11it/s]
 68% 13/19 [00:05<00:02,  2.11it/s]
 74% 14/19 [00:06<00:02,  2.10it/s]
 79% 15/19 [00:06<00:01,  2.10it/s]
 84% 16/19 [00:07<00:01,  2.10it/s]
 89% 17/19 [00:07<00:00,  2.10it/s]
 95% 18/19 [00:08<00:00,  2.10it/s]
                                     
{'eval_loss': '0.1513', 'eval_accuracy': '0.9732', 'eval_runtime': '8.901', 'eval_samples_per_second': '16.74', 'eval_steps_per_second': '2.135', 'epoch': '4'}
 80% 600/750 [11:16<02:09,  1.16it/s]
100% 19/19 [00:08<00:00,  2.35it/s]
{'loss': '1.181e-05', 'grad_norm': '0.0002724', 'learning_rate': '3.4e-06', 'epoch': '4.667'}
 93% 700/750 [13:01<00:52,  1.04s/it]
  0% 0/19 [00:00<?, ?it/s]
 11% 2/19 [00:00<00:04,  4.19it/s]
 16% 3/19 [00:00<00:05,  2.95it/s]
 21% 4/19 [00:01<00:05,  2.56it/s]
 26% 5/19 [00:01<00:05,  2.37it/s]
 32% 6/19 [00:02<00:05,  2.28it/s]
 37% 7/19 [00:02<00:05,  2.21it/s]
 42% 8/19 [00:03<00:05,  2.18it/s]
 47% 9/19 [00:03<00:04,  2.15it/s]
 53% 10/19 [00:04<00:04,  2.13it/s]
 58% 11/19 [00:04<00:03,  2.12it/s]
 63% 12/19 [00:05<00:03,  2.11it/s]
 68% 13/19 [00:05<00:02,  2.11it/s]
 74% 14/19 [00:06<00:02,  2.11it/s]
 79% 15/19 [00:06<00:01,  2.10it/s]
 84% 16/19 [00:07<00:01,  2.10it/s]
 89% 17/19 [00:07<00:00,  2.10it/s]
 95% 18/19 [00:08<00:00,  2.10it/s]
                                     
{'eval_loss': '0.1525', 'eval_accuracy': '0.9732', 'eval_runtime': '8.902', 'eval_samples_per_second': '16.74', 'eval_steps_per_second': '2.134', 'epoch': '4.667'}
 93% 700/750 [13:10<00:52,  1.04s/it]
100% 19/19 [00:08<00:00,  2.35it/s]
{'train_runtime': '843.5', 'train_samples_per_second': '7.084', 'train_steps_per_second': '0.889', 'train_loss': '0.03373', 'epoch': '5'}
100% 750/750 [14:03<00:00,  1.12s/it]
--------------------------------------------------
Evaluating on test set...
100% 19/19 [00:08<00:00,  2.24it/s]
Test results: {'eval_loss': 0.07795847207307816, 'eval_accuracy': 0.9866666666666667, 'eval_runtime': 8.9823, 'eval_samples_per_second': 16.7, 'eval_steps_per_second': 2.115, 'epoch': 5.0}
--------------------------------------------------
Saving model adapters and tokenizer to models/qwen_0.6b_lora_sms...
Model saved successfully.
